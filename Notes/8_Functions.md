# 函数
Javascript中的函数，是只定义一次，但可以被执行或调用多次的代码。Javascript函数是参数化的：函数的定义包括一个称为形参(parameter)的标识符列表，这些参数在函数体中像局部变量一样工作。函数调用会为形参提供实参的值。函数使用实参的值为计算返回值，成为该函数调用表达式的值。每次调用还会拥有另一个值，this关键字，表示本次调用的上下文。

如果函数挂载在一个对象上，作为对象的一个属性，就稀烂它为对象的方法。当通过这个对象来调用函数时，该对象就j此次调用的上下文，也就是该函数的this的值。用于初始化一个新创建的对象的函数称为构造函数(constructor)。

在Javascript里，函数即对象，程序可以随意操控它们，比如，Javascript可以把函数赋值给变量，或者作为参数传递给其他函数。因为函数就是对象，所以可以给它们设置属性，甚至调用它们的方法。

Javascript的函数可以嵌套在其他函数中定义，这样它们就可以访问它们被定义时所处的作用域中的任何变量。这意味着Javascript函数构成了一个闭包(closure)，它给Javascript带来了非常强劲的编程能力。

## 8.1 函数的定义
函数使用function关键字来定义，它可以用在函数定义表达式或者函数声明语句里。在两种形式中，函数定义都从function关键字开始，其后跟随这些组成部分：
* 函数名称标识符。函数名称是函数声明语句的必需的部分。它的用途就像变量的名字，新定义的函数对象会赋值给这个变量。对函数定义表达式来说，这个名字是可选的：如果存在，该名字只存在于函数体中，并指代该函数对象本身。
* 一对圆括号，其中包含由0个或者多个用逗号隔开的标识符组成的列表。这些标识符是函数的参数名称，它们就像函数体中的局部变量一样。
* 一对花括号，其中包含0条或者多条Javascript语句。这些语句构成了函数体：一旦调用函数，就会执行这些语句。

函数定义实例如下：

```javascript
// 输出o的每个属性的名称和值，返回undefined
function printprops(o) {
	for(var p in o) {
		console.log(p + ': ' + o[p] + '\n');
	}
}

// 计算两个笛卡尔坐标(x1, y1)和(x2, y2)之间的距离
function distance(x1, y1, x2, y2) {
	var dx = x2 - x1;
	var dy = y2 - y1;
	return Math.sqrt(dx * dx + dy * dy);
}

// 计算阶乘的递归函数
function factorial(x) {
	if (x <= 1) return 1;
	return x * factorial(x - 1);
}

// 求平方
var square = function(x) { return x * x; };

// 函数表达式可以包含名称，这在递归时很有用
var f = function fact(x) { if (x <= 1) return 1; else return x * fact(x - 1); };

// 函数作为参数
data.sort(function(a, b) { return a - b; });

// 函数表达式在定义后立即使用
var tensquared = (function(x) { return x * x; }(10));
```

以表达式方式定义的函数，函数的名称是可选的。一条函数声明语句实际上声明了一个变量，并把一个函数对象赋值给它。相对而言，定义函数表达式时并没有声明一个变量。

### 嵌套函数
在Javascript里，函数可以嵌套在其他函数里，如：

```javascript
function hypotenuse(a, b) {
	function square(x) { return x * x; }
	return Math.sqrt(square(a) + square(b));
}
```

嵌套函数的可以访问嵌套它们的函数的参数和变量。例如，在上面的代码里，内部函数square()可以读写外部函数hypotenuse()定义的参数a和b。

函数声明只能出现在全局代码里，或者内嵌在其他函数中。而函数定义表达式不受此限制。

## 8.2 函数调用
构成函数主体的Javascript代码在定义时并不会执行，只有调用该函数时，它们才会执行。调用Javascript函数的方法有：
* 作为函数
* 作为方法
* 作为构造函数
* 通过它们的call()和apply()方法间接调用

### 8.2.1 函数调用
使用调用表达式可以进行普通的函数调用也可进行方法调用。一个调用表达式由多个函数表达式组成，每个函数表达式都是由一个函数对象和左圆括号、参数列表和右圆括号组成，参数列表是由逗号分隔的零个或多个参数表达式组成。如果函数表达式是一个属性访问表达式，那么它就是一个方法调用表达式。

在一个调用中，每个参数表达式都会计算出一个值，计算的结果作为参数传递给另外一个函数。这些值作为实参传递给声明函数时定义的形参。

对于普通的函数调用，函数的返回值成为调用表达式的值。如果该函数返回是因为解释器到达结尾，返回值就是undefined。如果函数返回是因为解释器执行到一条return语句，返回值就是return之后的表达式的值，如果return语句没有值，则返回undefined。

在ECMAScript 3和非严格的ECMAScript 5对函数的调用的规定，调用上下文是全局对象。然后，在严格模式下，调用上下文则是undefined。

以函数形式调用的函数通常不使用this关键字。不过，this可以用来判断当前是否是严格模式：

```javascript
var strict = (function() { return !this; }());
```

### 8.2.2 方法调用
方法无非是个保存在一个对象的属性里的Javascript函数。如果有一个函数f和一个对象o，则可以用下面的代码给o定义一个名为m()的方法：

```javascript
o.m = f;
```

给o定义了方法m()，调用它时就像这样：

```javascript
o.m();
```

上面的代码是一个调用表达式：它包括一个函数表达式o.m，以及空的实参列表，函数表达式本身就是一个属性访问表达式，这意味着该函数被当做一个方法，而不是作为一个普通函数来调用。

对方法调用的参数和返回值的处理，和普通函数调用完全一致。一个重要的区别就是调用上下文不同。方法调用中this引用该对象。如：

```javascript
var calculator = {
	operand1: 1,
	operand2: 1,
	add: function(){
		this.result = this.operand1 + this.operand2;
	}
};
calculator.add();		
calculator.result;		// 2
```



### 8.2.3 构造函数调用

### 8.2.4 间接调用

## 8.3 函数的实参和形参

### 8.3.1 可选形参

### 8.3.2 可变长的实参列表：实参对象

### 8.3.3 将对象属性用做实参

### 8.3.4 实参类型

## 8.4 作为值的函数

## 8.5 作为命名空间的函数

## 8.6 闭包

## 8.7 函数属性、方法和构造函数

### 8.7.1 length属性

### 8.7.2 prototype属性

### 8.7.3 call()方法和apply()方法和apply

### 8.7.4 bind()方法

### 8.7.5 toString()方法

### 8.7.6 Function()构造函数

### 8.7.7 可调用的对象

## 8.8 函数式编程

### 8.8.1 使用函数处理数组

### 8.8.2 高阶函数

### 8.8.3 不完全函数

### 8.8.4 记忆






Author website: [furzoom](http://furzoom.com/about-us/ "Furzoom")
